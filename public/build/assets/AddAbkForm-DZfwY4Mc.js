import{r as l,j as e,a as s}from"./app-BCXNxsvu.js";import{M as w}from"./index-DqBy_bOg.js";import{F as o}from"./index-CeOsWrVz.js";import{I as F}from"./index-CCBrNHrs.js";import{S as d}from"./index-DT3GEK5Q.js";import{T as m}from"./index-Xv2Eix1U.js";import"./index-jkWDoZuv.js";import"./button-DYp94kPC.js";import"./PurePanel-BvOf297_.js";import"./zoom-Dv1Wj_dI.js";import"./ActionButton-BA_aWDSj.js";import"./useLocale-BdT_xuzA.js";import"./row-DByOmR57.js";import"./index-Ctvgr8PY.js";import"./index-CqUmIfNG.js";import"./DownOutlined-DM4bYnaF.js";const O=({visible:c,onCancel:u,unitKerja:p,handleCreate:b,form:r})=>{const[h,j]=l.useState([]),[k,x]=l.useState(null),g=async a=>{x(a);try{const t=await s.get("/api/get-available-jabatan",{params:{unit_kerja_id:a}});j(t.data.map(i=>({value:i.id,label:i.nama})))}catch(t){console.error("Failed to fetch jabatan:",t)}},f=(a,t)=>{const i=r.getFieldValue("abk"),n=r.getFieldValue("jabatan_id");return console.log({jabatan_id:n}),n===55||t>=0&&t<=i?Promise.resolve():Promise.reject(new Error("Nilai Eksisting tidak boleh lebih dari nilai ABK!"))};return l.useEffect(()=>{async function a(){try{const{data:t}=await s.get(route("api.token.csrf"));r.setFieldValue("_token",t)}catch{console.log("error get token")}}a()},[]),e.jsx(w,{title:"Tambah ABK",open:c,onCancel:u,onOk:()=>r.submit(),width:600,okText:"Tambah",cancelText:"Batal",children:e.jsxs(o,{form:r,name:"control-hooks",onFinish:b,onKeyDown:a=>{a.code==="Enter"&&r.submit()},onValuesChange:()=>r.validateFields(),style:{maxWidth:600},layout:"vertical",wrapperCol:{span:24},autoComplete:"off",size:"large",children:[e.jsx(o.Item,{hidden:!0,name:"_token",children:e.jsx(F,{})}),e.jsx(o.Item,{name:"unit_kerja_id",label:"Satuan Kerja",rules:[{required:!0}],children:e.jsx(d,{placeholder:"Pilih Satuan Kerja",allowClear:!0,showSearch:!0,optionFilterProp:"label",options:p.map(a=>({value:a.id,label:a.nama})),onChange:g})}),e.jsx(o.Item,{name:"jabatan_id",label:"Jabatan",rules:[{required:!0}],initialValue:null,children:e.jsx(d,{placeholder:"Pilih Jabatan",showSearch:!0,optionFilterProp:"label",disabled:!k,options:h})}),e.jsx(o.Item,{name:"abk",label:"ABK",rules:[{required:!0,message:"ABK tidak boleh kosong."}],children:e.jsx(m,{className:"border w-full border-slate-400 rounded-md"})}),e.jsx(o.Item,{name:"eksisting",label:"Eksisting",rules:[{validator:f}],children:e.jsx(m,{className:"border w-full border-slate-400 rounded-md"})})]})})};export{O as default};
