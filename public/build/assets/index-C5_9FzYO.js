import{r as u,j as t,Y as O,a as s,y as p}from"./app-Ckwfldo6.js";import{A as I}from"./AuthenticatedLayout-DQl7Gxj4.js";import T from"./TablePak-es8CWy4q.js";import{B as D}from"./Breadcrumb-DqTWDHWQ.js";import{S as G,P as L}from"./Pagination-BWiGRqZO.js";import R from"./ExportModal-DqS3BECb.js";import f from"./PegawaiForm-DX4lYhLH.js";import{d as b}from"./dayjs.min-BbOGNvIO.js";import{F as g}from"./index-Fm0elnVJ.js";import{s as V}from"./index-BYZ32yCc.js";import{R as U}from"./PlusOutlined-Buo5eWL0.js";import"./Header-DAuiMwIN.js";import"./index-l94Sujvl.js";import"./warning-BJoWgFIX.js";import"./zoom-bMYoQ7Vl.js";import"./index-Icf73h8N.js";import"./button-BGBTfVwN.js";import"./AntdIcon-Cz3qoJxW.js";import"./index-DcnuERgT.js";import"./ActionButton-DwuDipHy.js";import"./useLocale-DYPiGLR6.js";import"./index-7Cmv1Tnr.js";import"./index-BMOiOl8V.js";import"./PurePanel-DWqBgD2b.js";import"./index-BUT-_0VL.js";import"./index-6OpVtltX.js";import"./row-CLtprE_E.js";import"./index-CIMSJ8iy.js";import"./EyeOutlined-DG5P2W3k.js";import"./index-IqNrELqO.js";import"./DownOutlined-Ca5nFsa7.js";import"./index-xG_g3zzA.js";import"./index-Dzrgy74O.js";const we=({auth:r,pegawai:a,search:k,jabatan:h,unitKerja:x})=>{const[l]=g.useForm(),[m]=g.useForm(),[o,j]=V.useMessage(),[M,c]=u.useState(!1),[w,d]=u.useState(!1),[F,y]=u.useState(!1),P=()=>c(!0),S=()=>{c(!1),m.resetFields()},E=()=>y(!0),_=()=>y(!1),v=e=>{e&&(e.bulan_mulai?e.bulan=[b(e.bulan_mulai),b(e.bulan_selesai)]:e.bulan=[null,null]),l.setFieldsValue(e),d(!0)},A=()=>{d(!1),l.resetFields()},C=async e=>{try{o.open({type:"loading",content:"Menghapus data pegawai",key:"handle-delete"});const{data:n}=await s.get(route("api.token.csrf")),i=s.delete(route("singkat.admin.pegawai.destroy",{pegawai:e,_token:{data:n}}));o.open({type:"success",content:"Berhasil menyimpan perubahan",key:"handle-delete"})}catch{o.open({type:"error",content:"Gagal menghapus, periksa kembali !",key:"handle-delete"})}finally{p.reload({preserveState:!0,preserveScroll:!0,method:"get"}),l.resetFields()}},B=e=>{p.get(route("singkat.admin.pegawai"),{search:e},{replace:!0})},K=async e=>{const{data:n}=await s.get(route("api.token.csrf"));try{o.open({type:"loading",content:"Menyimpan perubahan",key:"handle-save"}),e.bulan&&(e.bulan_mulai=e.bulan[0],e.bulan_selesai=e.bulan[1],delete e.bulan),e._token=n;const i=s.put(route("singkat.admin.pegawai.update",{pegawai:e.id}),e,{headers:{"Content-Type":"application/json"}});o.open({type:"success",content:"Berhasil menyimpan perubahan",key:"handle-save"})}catch(i){console.log({error:i}),o.open({type:"error",content:"Gagal menyimpan, hubungi pengembang web!",key:"handle-save"})}finally{d(!1),p.reload({preserveState:!0,preserveScroll:!0})}},N=async e=>{const{data:n}=await s.get(route("api.token.csrf"));try{o.open({type:"loading",content:"Menambahkan pegawai",key:"handle-create"}),e.bulan_mulai=e.bulan[0],e.bulan_selesai=e.bulan[1],delete e.bulan,e._token=n;const i=await s.post(route("singkat.admin.pegawai.store"),e,{headers:{"Content-Type":"application/json"}});o.open({type:"success",content:"Berhasil menambahkan pegawai",key:"handle-create"})}catch{o.open({type:"error",content:"Gagal menambahkan, periksa kembali isian !",key:"handle-create"})}finally{c(!1),p.reload({preserveState:!0,preserveScroll:!0})}};return t.jsxs(I,{user:r.user,children:[j,t.jsx(O,{title:r.user.role=="viewer"?"PAK":"Kelola PAK"}),t.jsx(D,{pageName:r.user.role=="viewer"?"PAK":"Kelola PAK"}),t.jsxs("div",{className:"flex flex-row sm:justify-between mb-5",children:[t.jsx(G,{initialQuery:k,handleSearch:B}),t.jsxs("div",{children:[t.jsxs("button",{onClick:E,type:"button",className:"inline-flex items-center justify-center gap-2.5 rounded-md bg-primary py-2 px-5 text-center font-medium text-white hover:bg-opacity-90 lg:px-8 xl:px-5 mr-4",children:[t.jsx("span",{children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-4",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})})}),"Unduh Data"]}),["operator"].includes(r.user.role)&&t.jsxs("button",{onClick:()=>{m.resetFields(),P()},className:" gap-2.5 rounded-md    inline-flex items-center justify-center bg-meta-3 py-2 px-5  text-center font-medium text-white hover:bg-opacity-90 lg:px-8 xl:px-5 mr-4",children:[t.jsx(U,{})," Tambah Pegawai"]})]})]}),t.jsxs("div",{className:"flex flex-col gap-10",children:[t.jsx(T,{pegawai:a,onEdit:v,onDelete:C,role:r.user.role}),t.jsx(L,{links:a.links,currentPage:a.current_page,lastPage:a.last_page,total:a.total,from:a.from,to:a.to})]}),t.jsx(f,{jabatan:h,unitKerja:x,visible:M,onCancel:S,role:r.user.role,onFinish:N,type:"create",title:"Tambah Pegawai",form:m},"create-form"),t.jsx(f,{jabatan:h,unitKerja:x,visible:w,onCancel:A,role:r.user.role,onFinish:K,type:"edit",title:"Ubah Data Pegawai",form:l},"edit-form"),t.jsx(R,{visible:F,onCancel:_})]})};export{we as default};
