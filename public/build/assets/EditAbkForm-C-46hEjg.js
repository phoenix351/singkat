import{r as u,a as w,j as e}from"./app-BCXNxsvu.js";import{F as t}from"./index-CeOsWrVz.js";import{M as S}from"./index-DqBy_bOg.js";import{I as c}from"./index-CCBrNHrs.js";import{S as h}from"./index-DT3GEK5Q.js";import{T as b}from"./index-Xv2Eix1U.js";import"./PurePanel-BvOf297_.js";import"./index-jkWDoZuv.js";import"./button-DYp94kPC.js";import"./zoom-Dv1Wj_dI.js";import"./row-DByOmR57.js";import"./index-Ctvgr8PY.js";import"./useLocale-BdT_xuzA.js";import"./ActionButton-BA_aWDSj.js";import"./index-CqUmIfNG.js";import"./DownOutlined-DM4bYnaF.js";const R=({visible:j,onCancel:x,handleSave:f,abk:i,jabatan:k,unitKerja:g,role:l})=>{const[r]=t.useForm(),[_,K]=u.useState([]),[I,E]=u.useState(null);u.useEffect(()=>{i&&(r.setFieldsValue(i),i.unit_kerja_id&&p(i.unit_kerja_id,i.jabatan_id))},[i,r]);const F=(a,o)=>{const n=r.getFieldValue("abk");return o>=0&&o<=n?Promise.resolve():Promise.reject(new Error("Nilai Eksisting tidak boleh lebih dari nilai ABK!"))},p=async(a,o=null)=>{E(a);try{let d=(await w.get(route("index")+"/api/get-available-jabatan",{params:{unit_kerja_id:a}})).data.map(s=>({value:s.id,label:s.nama}));if(o){const s=k.find(m=>m.id===o);s&&!d.some(m=>m.value===o)&&d.push({value:s.id,label:s.nama})}K(d)}catch(n){console.error("Failed to fetch jabatan:",n)}};return e.jsx(S,{title:"Edit ABK",open:j,onCancel:x,onOk:()=>r.submit(),width:600,okText:"Simpan",cancelText:"Batal",children:e.jsxs(t,{form:r,name:"control-hooks",onFinish:f,onKeyDown:a=>{a.code==="Enter"&&r.submit()},style:{maxWidth:600},layout:"vertical",wrapperCol:{span:24},autoComplete:"off",size:"large",children:[e.jsx(t.Item,{name:"_token",hidden:!0,children:e.jsx(c,{})}),e.jsx(t.Item,{name:"id",hidden:!0,children:e.jsx(c,{})}),e.jsx(t.Item,{name:"unit_kerja_id",label:"Unit Kerja",rules:[{required:!0,message:"Unit Kerja tidak boleh kosong."}],children:e.jsx(h,{...l==="admin"?{}:{disabled:!0},placeholder:"Pilih Unit Kerja",showSearch:!0,optionFilterProp:"label",onChange:a=>p(a),options:g.map(a=>({value:a.id,label:a.nama}))})}),e.jsx(t.Item,{name:"jabatan_id",label:"Nama Jabatan",rules:[{required:!0,message:"Jabatan tidak boleh kosong."}],children:e.jsx(h,{...l==="admin"?{}:{disabled:!0},placeholder:"Pilih Jabatan",showSearch:!0,optionFilterProp:"label",options:_})}),e.jsx(t.Item,{name:"abk",label:"ABK",rules:[{required:!0,message:"ABK tidak boleh kosong."}],children:e.jsx(b,{...l==="admin"?{}:{disabled:!0},className:"border w-full border-slate-400 rounded-md"})}),e.jsx(t.Item,{rules:[{validator:F}],name:"eksisting",label:"Eksisting",children:e.jsx(b,{className:"border w-full border-slate-400 rounded-md"})})]})})};export{R as default};
