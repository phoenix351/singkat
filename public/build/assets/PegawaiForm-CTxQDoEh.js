import{r as k,j as a,a as J}from"./app-DFnwsWrs.js";import{d as s}from"./dayjs.min-DmyZntuv.js";import{M as T}from"./index-CxLqXYg-.js";import{F as e}from"./index-D6qsxmpK.js";import{I as o}from"./index-Ch6NPk6K.js";import{S as d}from"./index-CdkzHvRD.js";import{T as m}from"./index-zPBp9yDv.js";import{D as z}from"./index-BcJBgg6P.js";import"./index-7Nr_NS3U.js";import"./button-Bz9USzm7.js";import"./PurePanel-CRgtzXFw.js";import"./zoom-B0W9qZb7.js";import"./ActionButton-CtM_w2vP.js";import"./useLocale-Bol56ME6.js";import"./BaseInput-DmJDSday.js";import"./row-PkYKM1PI.js";import"./index-BbNNQxMk.js";import"./index-BZT0KOT1.js";import"./DownOutlined-N7VHuyP1.js";const{RangePicker:q}=z,B=(I,n)=>n?/^\d{18}$/.test(n)?Promise.resolve():Promise.reject(new Error("NIP harus terdiri dari 18 angka.")):Promise.reject(new Error("NIP tidak boleh kosong.")),L=(I,n)=>n?/^\d{9}$/.test(n)?Promise.resolve():Promise.reject(new Error("NIP BPS harus tediri dari 9 digit angka.")):Promise.reject(new Error("NIP BPS tidak boleh kosong.")),sa=({visible:I,onCancel:n,pegawai:l,jabatan:_,unitKerja:S,role:U,onFinish:M,type:u,title:D,form:t})=>{const i=async()=>{await t.validateFields();const r=t.getFieldValue("angka_kredit_dasar")||0,b=t.getFieldValue("jabatan_id"),{data:g}=await J.get(`/api/jabatans/${b}`),P=g.angka_kredit||0,j={"SD/sederajat":0,"SLTP/sederajat":0,"SLTA/sederajat":0,DI:0,DII:0,DIII:0,"S1/DIV/sederajat":0,S2:1,S3:1},c=t.getFieldValue("ijazah_terakhir");let p=0;c&&j.hasOwnProperty(c)&&(p=P*j[c]);const{fromDate:x,toDate:v}={fromDate:new Date(t.getFieldValue("bulan")[0]),toDate:new Date(t.getFieldValue("bulan")[1])},F=x.getMonth(),w=v.getMonth(),K=v.getFullYear()-x.getFullYear(),C=w-F+1+K*12,A=t.getFieldValue("predikat_id"),y=P*h[A-1].nilai*C/12,E=r+p+y;t.setFieldValue("akumulasi_ak",Number(E).toFixed(4))},[h,N]=k.useState([]),f=async()=>{try{const{data:r}=await J.get("/api/predikats");N(r)}catch{console.error("Error when get predikat data")}};k.useEffect(()=>{f()},[]),k.useEffect(()=>{l&&(l.bulan_mulai?l.bulan=[s(l.bulan_mulai),s(l.bulan_selesai)]:l.bulan=[null,null],t.setFieldsValue(l))},[l]);const V=[{label:"Juru Muda/Ia",value:"Juru Muda/Ia"},{label:"Juru Muda Tingkat I/Ib",value:"Juru Muda Tingkat I/Ib"},{label:"Juru/Ic",value:"Juru/Ic"},{label:"Juru Tingkat I/Id",value:"Juru Tingkat I/Id"},{label:"Juru Pengatur Muda/IIa",value:"Juru Pengatur Muda/IIa"},{label:"Juru Pengatur Muda Tingkat I/IIb",value:"Juru Pengatur Muda Tingkat I/IIb"},{label:"Juru Pengatur/IIc",value:"Juru Pengatur/IIc"},{label:"Juru Pengatur Tingkat I/IId",value:"Juru Pengatur Tingkat I/IId"},{label:"Juru Penata Muda/IIIa",value:"Juru Penata Muda/IIIa"},{label:"Juru Penata Muda Tingkat I/IIIb",value:"Juru Penata Muda Tingkat I/IIIb"},{label:"Juru Penata/IIIc",value:"Juru Penata/IIIc"},{label:"Juru Penata Tingkat I/IIId",value:"Juru Penata Tingkat I/IIId"},{label:"Juru Pembina/IVa",value:"Juru Pembina/IVa"},{label:"Juru Pembina Tingkat I/IVb",value:"Juru Pembina Tingkat I/IVb"},{label:"Juru Pembina Tingkat Utama Muda/IVc",value:"Juru Pembina Tingkat Utama Muda/IVc"},{label:"Juru Pembina Tingkat Utama Madya/IVd",value:"Juru Pembina Tingkat Utama Madya/IVd"},{label:"Juru Pembina Tingkat Utama/IVe",value:"Juru Pembina Tingkat Utama/IVe"}];return a.jsx(T,{title:`${D} ${t.getFieldValue("nama")}  (${t.getFieldValue("nip_bps")})`,open:I,style:{top:20},onCancel:n,onOk:()=>t.submit(),width:600,okText:"Simpan",cancelText:"Batal",children:a.jsxs(e,{form:t,onFinish:M,layout:"vertical",wrapperCol:{span:24},autoComplete:"off",size:"large",children:[a.jsx(e.Item,{name:"id",hidden:!0,children:a.jsx(o,{})}),a.jsx(e.Item,{name:"nip_bps",label:"NIP BPS",rules:[{required:!0,validator:L}],hidden:u==="edit",children:a.jsx(o,{placeholder:"Masukkan NIP lama contoh : 32002098",className:"border border-slate-400 rounded-md"})}),a.jsx(e.Item,{name:"nip",label:"NIP",rules:[{required:!0,validator:B}],hidden:u==="edit",children:a.jsx(o,{placeholder:"Masukkan NIP baru contoh : 198810232001041002",className:"border border-slate-400 rounded-md"})}),a.jsx(e.Item,{name:"nama",label:"Nama Pegawai",rules:[{required:!0}],hidden:u==="edit",children:a.jsx(o,{placeholder:"Nama Lengkap Tanpa Singkatan",className:"border border-slate-400 rounded-md"})}),a.jsx(e.Item,{name:"unit_kerja",label:"Satuan Kerja",rules:[{required:!0}],className:"focus:border-none",children:a.jsx(d,{placeholder:"Pilih Satuan Kerja",allowClear:!0,showSearch:!0,optionFilterProp:"label",options:S.map(r=>({label:r.nama,value:r.nama}))})}),a.jsx(e.Item,{name:"jabatan_id",label:"Jabatan",rules:[{required:!0}],className:"focus:border-none",children:a.jsx(d,{allowClear:!0,showSearch:!0,placeholder:"Pilih Jabatan Pegawai",optionFilterProp:"label",onChange:()=>{T.confirm({title:"Konfirmasi",content:"Mengubah jabatan pegawai akan mereset akumulasi angka kredit menjadi 0 (nol) !",footer:(r,{OkBtn:b,CancelBtn:g})=>a.jsx(a.Fragment,{children:a.jsx(b,{})})}),i()},options:_.map(r=>({label:r.nama,value:r.id}))})}),a.jsx(e.Item,{name:"pangkat_golongan_ruang",label:"Pangkat / Golongan Ruang",rules:[{required:!0}],children:a.jsx(d,{allowClear:!0,showSearch:!0,placeholder:"Penata Muda/IIIa",className:"border border-slate-400 rounded-md",options:V})}),a.jsx(e.Item,{name:"angka_kredit_konvensional",label:"Angka Kredit Konvensional",hidden:u==="edit",children:a.jsx(m,{className:"border w-[30%] border-slate-400 rounded-md"})}),a.jsx(e.Item,{name:"angka_kredit_integrasi",label:"Angka Kredit Integrasi",hidden:u==="edit",children:a.jsx(m,{className:"border w-[30%] border-slate-400 rounded-md"})}),a.jsx(e.Item,{name:"angka_kredit_dasar",label:"Angka Kredit Dasar / Terakhir",className:"focus:border-none",onChange:()=>i(),children:a.jsx(m,{className:"border border-slate-400 rounded-md"})}),a.jsx(e.Item,{name:"ijazah_terakhir",label:"Ijazah Terakhir",children:a.jsx(d,{onSelect:()=>i(),placeholder:"Pilih Ijazah yang Ditamatkan",options:[{label:"SD/sederajat",value:"SD/sederajat"},{label:"SLTP/sederajat",value:"SLTP/sederajat"},{label:"SLTA/sederajat",value:"SLTA/sederajat"},{label:"DI",value:"DI"},{label:"DII",value:"DII"},{label:"DIII",value:"DIII"},{label:"S1/DIV",value:"S1/DIV/sederajat"},{label:"S2",value:"S2"},{label:"S3",value:"S3"}]})}),a.jsx(e.Item,{name:"bulan",label:"Bulan Penilaian",rules:[{required:!0}],children:a.jsx(q,{picker:"month",minDate:s("2019-01-01"),format:"MMMM YYYY",maxDate:s(),onChange:i})}),a.jsx(e.Item,{name:"predikat_id",label:"Predikat Kinerja",className:"focus:border-none",children:a.jsx(d,{placeholder:"Pilih Predikat",allowClear:!0,showSearch:!0,optionFilterProp:"label",onChange:i,options:h.map(r=>({label:r.nama,value:r.id}))})}),a.jsx(e.Item,{name:"akumulasi_ak",label:"Akumulasi Angka Kredit",children:a.jsx(m,{readOnly:!0,className:"border border-slate-400 rounded-md"})})]})})};export{sa as default};
