import{r as c,j as t,Y as N,a as d,y as l}from"./app-qozg50Md.js";import{A as O}from"./AuthenticatedLayout-Dj4ZOn3L.js";import I from"./TablePak-uABLNqGa.js";import{B as T}from"./Breadcrumb-Df9cuyMT.js";import{S as D,P as G}from"./Pagination-DJc09OSr.js";import L from"./ExportModal-D4IKpfOQ.js";import y from"./PegawaiForm-B5-BRO7v.js";import{d as f}from"./dayjs.min-kBRJ-rpy.js";import{F as b}from"./index-aOYu-vQh.js";import{s as R}from"./index-3LLh_nqc.js";import{R as V}from"./PlusOutlined-hv5tk13B.js";import"./Header-Cns69jfE.js";import"./index-CJyQPicH.js";import"./warning-Bf_VSDRp.js";import"./zoom-DM4q-JEj.js";import"./index-Cl5Xqjrl.js";import"./button-Bf_he-TK.js";import"./AntdIcon-oE3BgIqN.js";import"./index-DgYSkqUS.js";import"./ActionButton-CVruMRtK.js";import"./useLocale-BH1iDomU.js";import"./index-B-kb_xka.js";import"./index-BSk5wdO_.js";import"./PurePanel-CDwIu1rJ.js";import"./index-BP0t2nwt.js";import"./index-Ct0XMeLs.js";import"./row-D3mj2rtc.js";import"./index-DC3t1Uft.js";import"./EyeOutlined-BduE5REH.js";import"./index-DTsYXN2-.js";import"./DownOutlined-DKhpsX0H.js";import"./index-DZ7bMjgQ.js";import"./index-xlaZMbuE.js";const Me=({auth:r,pegawai:a,search:g,jabatan:u,unitKerja:h})=>{const[s]=b.useForm(),[i]=b.useForm(),[o,k]=R.useMessage(),[j,p]=c.useState(!1),[M,m]=c.useState(!1),[w,x]=c.useState(!1),F=()=>p(!0),P=()=>{p(!1),i.resetFields()},S=()=>x(!0),v=()=>x(!1),E=e=>{e&&(e.bulan_mulai?e.bulan=[f(e.bulan_mulai),f(e.bulan_selesai)]:e.bulan=[null,null]),s.setFieldsValue(e),m(!0)},A=()=>{m(!1),s.resetFields()},C=async e=>{try{o.open({type:"loading",content:"Menghapus data pegawai",key:"handle-delete"});const n=d.delete(route("singkat.admin.pegawai.destroy",{pegawai:e}));o.open({type:"success",content:"Berhasil menyimpan perubahan",key:"handle-delete"})}catch{o.open({type:"error",content:"Gagal menghapus, periksa kembali !",key:"handle-delete"})}finally{l.reload({preserveState:!0,preserveScroll:!0,method:"get"}),s.resetFields()}},_=e=>{l.get(route("singkat.admin.pegawai"),{search:e},{replace:!0})},B=async e=>{try{o.open({type:"loading",content:"Menyimpan perubahan",key:"handle-save"}),e.bulan&&(e.bulan_mulai=e.bulan[0],e.bulan_selesai=e.bulan[1],delete e.bulan);const n=d.put(route("singkat.admin.pegawai.update",{pegawai:e.id}),e,{headers:{"Content-Type":"application/json"}});o.open({type:"success",content:"Berhasil menyimpan perubahan",key:"handle-save"})}catch(n){console.log({error:n}),o.open({type:"error",content:"Gagal menyimpan, hubungi pengembang web!",key:"handle-save"})}finally{m(!1),l.reload({preserveState:!0,preserveScroll:!0})}},K=async e=>{try{o.open({type:"loading",content:"Menambahkan pegawai",key:"handle-create"}),e.bulan_mulai=e.bulan[0],e.bulan_selesai=e.bulan[1],delete e.bulan;const n=await d.post(route("singkat.admin.pegawai.store"),e,{headers:{"Content-Type":"application/json"}});o.open({type:"success",content:"Berhasil menambahkan pegawai",key:"handle-create"})}catch{o.open({type:"error",content:"Gagal menambahkan, periksa kembali isian !",key:"handle-create"})}finally{p(!1),l.reload({preserveState:!0,preserveScroll:!0})}};return t.jsxs(O,{user:r.user,children:[k,t.jsx(N,{title:r.user.role=="viewer"?"PAK":"Kelola PAK"}),t.jsx(T,{pageName:r.user.role=="viewer"?"PAK":"Kelola PAK"}),t.jsxs("div",{className:"flex flex-row sm:justify-between mb-5",children:[t.jsx(D,{initialQuery:g,handleSearch:_}),t.jsxs("div",{children:[t.jsxs("button",{onClick:S,type:"button",className:"inline-flex items-center justify-center gap-2.5 rounded-md bg-primary py-2 px-5 text-center font-medium text-white hover:bg-opacity-90 lg:px-8 xl:px-5 mr-4",children:[t.jsx("span",{children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-4",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})})}),"Unduh Data"]}),["operator"].includes(r.user.role)&&t.jsxs("button",{onClick:()=>{i.resetFields(),F()},className:" gap-2.5 rounded-md    inline-flex items-center justify-center bg-meta-3 py-2 px-5  text-center font-medium text-white hover:bg-opacity-90 lg:px-8 xl:px-5 mr-4",children:[t.jsx(V,{})," Tambah Pegawai"]})]})]}),t.jsxs("div",{className:"flex flex-col gap-10",children:[t.jsx(I,{pegawai:a,onEdit:E,onDelete:C,role:r.user.role}),t.jsx(G,{links:a.links,currentPage:a.current_page,lastPage:a.last_page,total:a.total,from:a.from,to:a.to})]}),t.jsx(y,{jabatan:u,unitKerja:h,visible:j,onCancel:P,role:r.user.role,onFinish:K,type:"create",title:"Tambah Pegawai",form:i},"create-form"),t.jsx(y,{jabatan:u,unitKerja:h,visible:M,onCancel:A,role:r.user.role,onFinish:B,type:"edit",title:"Ubah Data Pegawai",form:s},"edit-form"),t.jsx(L,{visible:w,onCancel:v})]})};export{Me as default};
